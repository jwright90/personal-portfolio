{% load static %}
{% include "../base.html" %}
{% block stylesheet%}
    <link rel="stylesheet" href="{% static '/css/home.css'%}">
{%endblock stylesheet%}

<div class="main-container">
    <div class="nav-container">
        <nav>
            <div class="link-container">
                <h1>Jason Wright</h1>
                <h6>Web Developer</h6>
            </div>
            <img src="{% static '/images/cork-board.jpg' %}" class="cork-board">
            <img src="{% static '/images/professional_400px.png'%}" class="profile">
            <div class="link-container">
                <a href="/">Home</a>
                <a href="/">About</a>
                <a href="#">Work</a>
                <a href="#">Contact</a>
            </div>
            <div class="social-icons">
                <a href="#"><i class="fab fa-linkedin"></i></a>
                <a href="#"><i class="fab fa-github-square"></i></a>
                <a href="#"><i class="fab fa-hackerrank"></i></a>
            </div>
        </nav>
    </div>

<div class="page-container">

        <div class="section-container">
            <h1>Project Highlights</h1>
            <button class="project-btn" id="prev-project" type='submit'>Prev</button>
            <button class="project-btn" id="next-project" type='submit'>Next</button>
            <div class="projects-container">
            <!--    JS to add python tags immediately after div with class "project-container" 
                    adjust slice values?
            -->
            {% for project in projects|slice:"0:1" %}
                <div class="project">
                    <div class="project-content">
                        <div class="project-header" id="project-header"></div>
                        <div class="project-text" id="project-description"></div>
                        <div class="project-tags" id ="project-tags">
                        <!--
                        {% for tag in project.tags.values %}
                            <p class="tag {{tag.tag_name}}"></p>
                        {% endfor %}
                        -->
                        </div>
                    </div>
                </div>

                <div class="project">
                    <div class="project-img-container">
                        <img src="" alt="project gif" class="project-img-gif" id="project-img-gif">
                    </div>
                </div>
            {% endfor %}
            </div>
        </div>

        <div class="section-container about-container">
            <div class="about-description">
                <h1>About</h1>
                <p> I'm a self-taught web developer with experience in HTML5, CSS3, Javascript and Python.</p>
                <p> I learned how to code because I love solving problems and exercising my creativity.</p>
                <p> Previously, I was a part-qualified management accountant.
                    I'd like to use my experience to produce web apps for SME finance teams.</p>
                
                <div class="about-learning">
                    <h6>Currently Learning</h6>
                    <p> As of 23rd Dec 2020, my plan is to follow a few more Django tutorials and work on some of my own projects.
                        After I'm done with this I'll be learning React.
                    </p>
                </div>
            </div>
            <div class="about-graphic">
                <h1>Skills</h1>
                    <p>HTML</p>
                        <div class="skill-container">
                        <div class="skills html-skill">65%</div>
                    </div>

                    <p>CSS</p>
                        <div class="skill-container">
                        <div class="skills css-skill">70%</div>
                    </div>

                    <p>JavaScript</p>
                        <div class="skill-container">
                        <div class="skills js-skill">50%</div>
                    </div>

                    <p>Python</p>
                        <div class="skill-container">
                        <div class="skills python-skill">35%</div>
                    </div>
                <div class="other-skills">
                    <h6>Other</h6>
                    <ul>
                        <li>Github</li>
                        <li>Heroku</li>
                        <li>Linux / Windows CLI</li>
                        <li>Visual Studio Code</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section-container">
            <h1>Work</h1>
            <div class="work-container">
                <div class="work work-list">
                    <table>
                    <tr>
                        <th>Projects</th>
                        <th>Tags</th>
                    </tr>
                    {% for project in projects %}
                        <tr>
                            <td>
                                <a href="{{project.project_url}}">{{project.project_name}}</a>
                            </td>
                            <td>
                                {% for tag in project.tags.values %}<p class="tag work-tag {{tag.tag_name}}">{{tag.tag_name}}</p>{% endfor %}
                            </td>
                        </tr>
                    {% endfor %}
                    </table>
                </div>
                <div class="work work-preview">
                    <h3>Preview</h3>
                </div>
            </div>
        </div>

        <div class="section-container contact-container">
            <h1>Contact</h1>
            <div class="contact-form-container">
                <form action="">
                    <div class="row">
                    <div class="col-2">
                        <label for="name">Name</label>
                    </div>
                    <div class="col">
                        <input type="text" id="name" name="name" placeholder="Name">
                    </div>
                    </div>
                    <div class="row">
                    <div class="col-2">
                        <label for="Email">Email</label>
                    </div>
                    <div class="col">
                        <input type="text" id="Email" name="Email" placeholder="Email">
                    </div>
                    </div>
                    <div class="row">
                    <div class="col-2">
                        <label for="message">Message</label>
                    </div>
                    <div class="col">
                        <textarea id="message" name="message" placeholder="Your message" style="height:200px"></textarea>
                    </div>
                    </div>
                    <div class="row">
                    <div class="col-2"></div>
                    <div class="col">
                    <input type="submit" value="Submit">
                    </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
let id = 0;

let projectsData = JSON.parse("{{ projects_json|escapejs }}");
console.log(projectsData[id].fields);

document.getElementById('next-project').addEventListener('click', incrementId);
document.getElementById('prev-project').addEventListener('click', decrementId);

function loadData(id) {
    document.getElementById('project-header').innerHTML = projectsData[id].fields.project_name;
    document.getElementById('project-description').innerHTML = projectsData[id].fields.project_description;

    let projectTags = projectsData[id].fields.tags;

    let tagsData = JSON.parse("{{ tags_json|escapejs }}");
    console.log(tagsData);

    var tagSearch = [];
    var tagSearchField = "pk";
    var tagSearchValues = projectTags;

    for (pk of tagSearchValues ) {
        for (var i = 0; i < tagsData.length; i++ ) {
            if (tagsData[i][tagSearchField] == pk ) {
                tagSearch.push(tagsData[i].fields.tag_name);
            }
        }
    }

    projTagContainer = document.getElementById('project-tags');

    for (tag of tagSearch) {
        projTagPara = document.createElement('p');
        projTextNode = document.createTextNode(tag);
        projTagPara.className = tag.concat(" tag");
        projTagPara.appendChild(projTextNode);
        projTagContainer.appendChild(projTagPara);
    }

    document.getElementById('project-img-gif').src = '/media/'.concat(projectsData[id].fields.project_img_gif)
}

loadData(id);

function incrementId() {
    if (id == (projectsData.length - 1)) {
        id = 0;
        document.getElementById('project-tags').innerHTML = "";
        loadData(id);
        return id;
    } else {
        id++;
        document.getElementById('project-tags').innerHTML = "";
        loadData(id);
        return id;
    }
}

function decrementId() {
    if (id == 0) {
        id = (projectsData.length - 1);
        document.getElementById('project-tags').innerHTML = "";
        loadData(id);
        return id;
    } else {
        id--;
        document.getElementById('project-tags').innerHTML = "";
        loadData(id);
        return id;
    }
}

</script>

{% block script %} 

{% endblock script %}

